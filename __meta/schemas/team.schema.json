{
  "type": "object",
  "required": [
    "slug",
    "name",
    "description",
    "contributing-guide",
    "maintainers",
    "contributors",
    "repos",
    "slack-channel-ids"
  ],
  "properties": {
    "name": {
      "type": "string",
      "description": "Used for any public-facing or display contexts (e.g. the GitHub team name)."
    },
    "slug": {
      "type": "string",
      "description": "Used for internal references (e.g. OIDC client ID)."
    },
    "website-slug": {
      "type": "string",
      "description": "Used in website URLs (e.g. <website-slug>.scottylabs.org)."
    },
    "description": {
      "type": "string",
      "description": "A brief description of the team."
    },
    "contributing-guide": {
      "type": "string",
      "description": "Guide on how to contribute to the team, preferably a link to a CONTRIBUTING.md file."
    },
    "maintainers": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "description": "The github usernames of the maintainers of the team. We assume there is no duplicates in the list."
    },
    "contributors": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "description": "The github usernames of the contributors of the team. There can be duplicates in the list."
    },
    "applicants": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "The github usernames of the applicants of the team."
    },
    "ext-admins": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "External individuals who need admin access to the app (e.g. orientation staffs for O-Quest) but are not involved in development."
    },
    "repos": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "The github repositories of the team, in the format of 'ScottyLabs/<repo-name>'."
    },
    "slack-channel-ids": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[CG][A-Z0-9]+$"
      },
      "description": "The Slack channel IDs of the team."
    },
    "remove-unlisted": {
      "type": "boolean",
      "description": "Whether to remove unlisted members from the team.",
      "default": true
    },
    "sync-github": {
      "type": "boolean",
      "description": "Whether to create Github teams and sync the team to GitHub.",
      "default": true
    },
    "sync-minio": {
      "type": "boolean",
      "description": "Whether to synchronize with MinIO object storage.",
      "default": false
    },
    "create-oidc-clients": {
      "type": "boolean",
      "description": "Whether to create OIDC clients for the team.",
      "default": true
    },
    "secrets-population-layout": {
      "type": "string",
      "description": "The secrets folder layout when populating secrets to HashiCorp Vault.",
      "oneOf": [
        {
          "const": "single",
          "description": "single: Populate secrets to a single folder."
        },
        {
          "const": "multi",
          "description": "multi: Populate secrets to multiple folders, one for each app (e.g. one for web and one for server)."
        },
        {
          "const": "none",
          "description": "none: No secrets population. Cannot be used with 'sync-minio' set to true."
        }
      ],
      "default": "multi"
    }
  },
  "additionalProperties": false,
  "allOf": [
    {
      "$comment": "Require 'website-slug' when 'create-oidc-clients' is missing or true.",
      "if": {
        "anyOf": [
          {
            "not": {
              "required": [
                "create-oidc-clients"
              ]
            }
          },
          {
            "properties": {
              "create-oidc-clients": {
                "const": true
              }
            }
          }
        ]
      },
      "then": {
        "required": [
          "website-slug"
        ]
      }
    },
    {
      "$comment": "Require 'secrets-population-layout' to not be 'none' when 'sync-minio' is true.",
      "if": {
        "properties": {
          "sync-minio": {
            "const": true
          }
        },
        "required": [
          "sync-minio"
        ]
      },
      "then": {
        "not": {
          "properties": {
            "secrets-population-layout": {
              "const": "none"
            }
          },
          "required": [
            "secrets-population-layout"
          ]
        }
      }
    }
  ]
}
